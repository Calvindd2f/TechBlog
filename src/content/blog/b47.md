---
title: Improving Your PowerShell Function
description: Development blog  post about improving powershell functions / creation of pslint
pubDate: Oct 08 2024
heroImage: /public/img/image.png
---

#TODO(@Calvindd2f): Insert content trail about why I created the pslint performance  tool ..  This is a development blog post about it.

## A Well-Structured PowerShell Function

```powershell
function Get-IPAddress {
    <#
    .SYNOPSIS
    Retrieves the IP address of the local machine.

    .DESCRIPTION
    This function retrieves the IP address of the local machine.

    .PARAMETER ComputerName
    The name of the computer to retrieve the IP address for.

    .EXAMPLE
    Get-IPAddress -ComputerName "localhost"
    #>

    [CmdletBinding()]
    param (
        [string]$ComputerName = "localhost"
    )

    # Function code here
}
```

**Suppressing Output in PowerShell**

```powershell
# Assign to $null
$arrayList = [System.Collections.ArrayList]::new()
foreach ($i in 0..10000) {
    $null = $arraylist.Add($i)
}

# Cast to [void]
$arrayList = [System.Collections.ArrayList]::new()
foreach ($i in 0..10000) {
    [void] $arraylist.Add($i)
}

# Redirect to $null
$arrayList = [System.Collections.ArrayList]::new()
foreach ($i in 0..10000) {
    $arraylist.Add($i) > $null
}

# Pipe to Out-Null
$arrayList = [System.Collections.ArrayList]::new()
foreach ($i in 0..10000) {
    $arraylist.Add($i) | Out-Null
}
```

**Using Hash Tables for Faster Lookups**

```powershell
$Results = $Employees | ForEach-Object -Process {
    $Email = $LookupHash[$_.Name].Email
    [pscustomobject]@{
        Id    = $_.Id
        Name  = $_.Name
        Email = $Email
    }
}
```

**Avoiding Repeated Calls to a Function**

```powershell
# Bad example
for ($i = 0; $i -lt 10000; $i++) {
    MyFunction
}

# Good example
MyFunction -Count 10000
```
